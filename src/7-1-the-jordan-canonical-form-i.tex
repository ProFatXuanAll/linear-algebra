\section{The Jordan Canonical Form I}\label{sec:7.1}

\begin{defn}\label{7.1.1}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\), and suppose that the characteristic polynomial of \(\T\) splits.
  Recall from \cref{5.9} that the diagonalizability of \(\T\) depends on whether the union of ordered bases for the distinct eigenspaces of \(\T\) is an ordered basis for \(\V\) over \(\F\).
  So a lack of diagonalizability means that at least one eigenspace of \(\T\) is too ``small.''

  In this section, we extend the definition of eigenspace to \emph{generalized eigenspace}.
  From these subspaces, we select ordered bases whose union is an ordered basis \(\beta\) for \(\V\) over \(\F\) such that
  \[
    [\T]_{\beta} = \begin{pmatrix}
      A_1    & \zm    & \cdots & \zm    \\
      \zm    & A_2    & \cdots & \zm    \\
      \vdots & \vdots &        & \vdots \\
      \zm    & \zm    & \cdots & A_k
    \end{pmatrix},
  \]
  where each \(\zm\) is a zero matrix, and each \(A_i\) is a square matrix of the form \((\lambda)\) or
  \[
    \begin{pmatrix}
      \lambda & 1       & 0      & \cdots & 0       & 0       \\
      0       & \lambda & 1      & \cdots & 0       & 0       \\
      \vdots  & \vdots  & \vdots &        & \vdots  & \vdots  \\
      0       & 0       & 0      & \cdots & \lambda & 1       \\
      0       & 0       & 0      & \cdots & 0       & \lambda
    \end{pmatrix}
  \]
  for some eigenvalue \(\lambda\) of \(\T\).
  Such a matrix \(A_i\) is called a \textbf{Jordan block} corresponding to \(\lambda\), and the matrix \([\T]_{\beta}\) is called a \textbf{Jordan canonical form} of \(\T\).
  We also say that the ordered basis \(\beta\) is a \textbf{Jordan canonical basis} for \(\T\).
  Observe that each Jordan block \(A_i\) is ``almost'' a diagonal matrix
  ---
  in fact, \([\T]_{\beta}\) is a diagonal matrix iff each \(A_i\) is of the form \((\lambda)\).
\end{defn}

\begin{note}
  In \cref{sec:7.1,sec:7.2}, we prove that every linear operator whose characteristic polynomial splits has a Jordan canonical form that is unique up to the order of the Jordan blocks.
  Nevertheless, it is not the case that the Jordan canonical form is completely determined by the characteristic polynomial of the operator.
\end{note}

\begin{defn}\label{7.1.2}
  Let \(\T\) be a linear operator on a vector space \(\V\) over \(\F\), and let \(\lambda \in \F\).
  Because of the structure of each Jordan block in a Jordan canonical form, we can generalize these observations:
  If \(v\) lies in a Jordan canonical basis for a linear operator \(\T\) and is associated with a Jordan block with diagonal entry \(\lambda\), then \((\T - \lambda \IT[\V])^p(v) = \zv\) for sufficiently large \(p\).
  Eigenvectors satisfy this condition for \(p = 1\).
  A nonzero vector \(x\) in \(\V\) is called a \textbf{generalized eigenvector of \(\T\) corresponding to \(\lambda\)} if \((\T - \lambda \IT[\V])^p(x) = \zv\) for some positive integer \(p\).
\end{defn}

\begin{cor}\label{7.1.3}
  Let \(\T\) be a linear operator on a vector space \(\V\) over \(\F\), and let \(\lambda \in \F\).
  If \(x\) is a generalized eigenvector of \(\T\) corresponding to \(\lambda\), and \(p\) is the smallest positive integer for which \((\T - \lambda \IT[\V])^p(x) = \zv\), then \((\T - \lambda \IT[\V])^{p - 1}(x)\) is an eigenvector of \(\T\) corresponding to \(\lambda\).
  Therefore \(\lambda\) is an eigenvalue of \(\T\).
\end{cor}

\begin{proof}[\pf{7.1.3}]
  Observe that
  \begin{align*}
             & (\T - \lambda \IT[\V])^p(x) = \zv                                   \\
    \implies & (\T - \lambda \IT[\V])\pa{(\T - \lambda \IT[\V])^{p - 1}(x)} = \zv.
  \end{align*}
  Since \(p\) is the smallest positive integer for which \((\T - \lambda \IT[\V])^p(x) = \zv\), we know that \((\T - \lambda \IT[\V])^{p - 1}(x) \neq \zv\).
  Thus by \cref{5.4} \((\T - \lambda \IT[\V])^{p - 1}(x)\) is an eigenvector of \(\T\) and therefore \(\lambda\) is an eigenvalue of \(\T\).
\end{proof}

\begin{defn}\label{7.1.4}
  Let \(\T\) be a linear operator on a vector space \(\V\) over \(\F\), and let \(\lambda\) be an eigenvalue of \(\T\).
  The \textbf{generalized eigenspace of \(\T\) corresponding to \(\lambda\)}, denoted \(\vs{K}_{\lambda}\), is the subset of \(\V\) defined by
  \[
    \vs{K}_{\lambda} = \set{x \in \V : (\T - \lambda \IT[\V])^p(x) = \zv \text{ for some } p \in \Z^+}.
  \]
  Note that \(\vs{K}_{\lambda}\) consists of the zero vector (\cref{2.1.2}(a)) and all generalized eigenvectors corresponding to \(\lambda\) (\cref{7.1.2}).
\end{defn}

\begin{thm}\label{7.1}
  Let \(\T\) be a linear operator on a vector space \(\V\) over \(\F\), and let \(\lambda \in \F\) be an eigenvalue of \(\T\).
  Then
  \begin{enumerate}
    \item \(\vs{K}_{\lambda}\) is a \(\T\)-invariant subspace of \(\V\) containing \(\vs{E}_{\lambda}\)
          (the eigenspace of \(\T\) corresponding to \(\lambda\)).
    \item For any scalar \(\mu \neq \lambda\), the restriction of \(\T - \mu \IT[\V]\) to \(\vs{K}_{\lambda}\) is one-to-one.
  \end{enumerate}
\end{thm}

\begin{proof}[\pf{7.1}(a)]
  Clearly, \(\zv \in \vs{K}_{\lambda}\).
  Suppose that \(x\) and \(y\) are in \(\vs{K}_{\lambda}\).
  Then by \cref{7.1.4} there exist positive integers \(p\) and \(q\) such that
  \[
    (\T - \lambda \IT[\V])^p(x) = (\T - \lambda \IT[\V])^q(y) = \zv.
  \]
  Therefore
  \begin{align*}
    (\T - \lambda \IT[\V])^{p + q}(x + y) & = (\T - \lambda \IT[\V])^{p + q}(x) + (\T - \lambda \IT[\V])^{p + q}(y) &  & \by{2.9}      \\
                                          & = (\T - \lambda \IT[\V])^q(\zv) + (\T - \lambda \IT[\V])^p(\zv)         &  & \by{7.1.4}    \\
                                          & = \zv,                                                                  &  & \by{2.1.2}[a]
  \end{align*}
  and hence \(x + y \in \vs{K}_{\lambda}\).
  Similarly,
  \begin{align*}
    \forall c \in \F, (\T - \lambda \IT[\V])^p(cx) & = c (\T - \lambda \IT[\V])^p(x) &  & \by{2.9}    \\
                                                   & = c \zv                         &  & \by{7.1.4}  \\
                                                   & = \zv                           &  & \by{1.2}[c]
  \end{align*}
  and hence \(cx \in \vs{K}_{\lambda}\).

  To show that \(\vs{K}_{\lambda}\) is \(\T\)-invariant, consider any \(x \in \vs{K}_{\lambda}\).
  Choose a positive integer \(p\) such that \((\T - \lambda \IT[\V])^p(x) = \zv\).
  Then
  \begin{align*}
    (\T - \lambda \IT[\V])^p \T(x) & = \T (\T - \lambda \IT[\V])^p(x) &  & \by{ex:5.4.4} \\
                                   & = \T(\zv)                        &  & \by{7.1.4}    \\
                                   & = \zv.                           &  & \by{2.1.2}[a]
  \end{align*}
  Therefore \(\T(x) \in \vs{K}_{\lambda}\).

  Finally, it is a simple observation that \(\vs{E}_{\lambda}\) is contained in \(\vs{K}_{\lambda}\).
\end{proof}

\begin{proof}[\pf{7.1}(b)]
  Let \(x \in \vs{K}_{\lambda}\) and \((\T - \mu \IT[\V])(x) = \zv\).
  By way of contradiction, suppose that \(x \neq \zv\).
  Let \(p\) be the smallest positive integer for which \((\T - \lambda \IT[\V])^p(x) = \zv\), and let \(y = (\T - \lambda \IT[\V])^{p - 1}(x)\).
  Then
  \[
    (\T - \lambda \IT[\V])(y) = (\T - \lambda \IT[\V])^p(x) = \zv,
  \]
  and hence \(y \in \vs{E}_{\lambda}\) (\cref{7.1.3}).
  Furthermore,
  \begin{align*}
    (\T - \mu \IT[\V])(y) & = (\T - \mu \IT[\V]) (\T - \lambda \IT[\V])^{p - 1}(x)  &  & \by{7.1.3}    \\
                          & = (\T - \lambda \IT[\V])^{p - 1} (\T - \mu \IT[\V]) (x) &  & \by{ex:5.4.4} \\
                          & = \zv,                                                  &  & \by{2.1.2}[a]
  \end{align*}
  so that \(y \in \vs{E}_{\mu}\).
  But by \cref{5.8} \(\vs{E}_{\lambda} \cap \vs{E}_{\mu} = \set{\zv}\), and thus \(y = \zv\), contrary to the hypothesis of \(p\).
  So \(x = \zv\), and the restriction of \(\T - \mu \IT[\V]\) to \(\vs{K}_{\lambda}\) is one-to-one.
\end{proof}

\begin{thm}\label{7.2}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\) such that the characteristic polynomial of \(\T\) splits.
  Suppose that \(\lambda\) is an eigenvalue of \(\T\) with multiplicity \(m\).
  Then
  \begin{enumerate}
    \item \(\dim(\vs{K}_{\lambda}) \leq m\).
    \item \(\vs{K}_{\lambda} = \ns{(\T - \lambda \IT[\V])^m}\).
  \end{enumerate}
\end{thm}

\begin{proof}[\pf{7.2}(a)]
  Let \(h\) be the characteristic polynomial of \(\T_{\vs{K}_{\lambda}}\).
  By \cref{5.21}, \(h\) divides the characteristic polynomial of \(\T\), and by \cref{7.1}(b), \(\lambda\) is the only eigenvalue of \(\T_{\vs{K}_{\lambda}}\).
  Hence \(h(t) = (-1)^d (t - \lambda)^d\), where \(d = \dim(\vs{K}_{\lambda})\) (\cref{2.5}), and \(d \leq m\).
\end{proof}

\begin{proof}[\pf{7.2}(b)]
  Clearly \(\ns{(\T - \lambda \IT[\V])^m} \subseteq \vs{K}_{\lambda}\).
  Now let \(h\) and \(d\) be as in (a).
  Then \(h(\T_{\vs{K}_{\lambda}})\) is identically zero by the Cayley--Hamilton theorem (\cref{5.23});
  therefore \((\T - \lambda \IT[\V])^d(x) = \zv\) for all \(x \in \vs{K}_{\lambda}\).
  Since \(d \leq m\), we have \(\vs{K}_{\lambda} \subseteq \ns{(\T - \lambda \IT[\V])^m}\).
\end{proof}

\begin{thm}\label{7.3}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\) such that the characteristic polynomial of \(\T\) splits, and let \(\seq{\lambda}{1,,k} \in \F\) be the distinct eigenvalues of \(\T\).
  Then, for every \(x \in \V\), there exist vectors \(v_i \in \vs{K}_{\lambda_i}\), \(i \in \set{1, \dots, k}\), such that
  \[
    x = \seq[+]{v}{1,,k}.
  \]
\end{thm}

\begin{proof}[\pf{7.3}]
  The proof is by mathematical induction on the number \(k\) of distinct eigenvalues of \(\T\).
  First suppose that \(k = 1\), and let \(m\) be the multiplicity of \(\lambda_1\).
  Then \((\lambda_1 - t)^m\) is the characteristic polynomial of \(\T\), and hence \((\lambda_1 \IT[\V] - \T)^m = \zT\) by the Cayley--Hamilton theorem (\cref{5.23}).
  Thus
  \begin{align*}
    \V & = \ns{\zT}                        &  & \by{2.3}    \\
       & = \ns{(\T - \lambda_1 \IT[\V])^m} &  & \by{5.23}   \\
       & = \vs{K}_{\lambda_1},             &  & \by{7.2}(b)
  \end{align*}
  and the result follows.

  Now suppose that for some integer \(k \geq 1\), the result is established whenever \(\T\) has fewer than \(k + 1\) distinct eigenvalues, and suppose that \(\T\) has \(k + 1\) distinct eigenvalues.
  Let \(m\) be the multiplicity of \(\lambda_{k + 1}\), and let \(f\) be the characteristic polynomial of \(\T\).
  Then \(f(t) = (t - \lambda_{k + 1})^m g(t)\) for some polynomial \(g\) not divisible by \((t - \lambda_{k + 1})\).
  Let \(\W = \rg{(\T - \lambda_{k + 1} \IT[\V])^m}\).
  Then \(\W\) is \(\T\)-invariant since
  \begin{align*}
             & \forall y \in \rg{(\T - \lambda_{k + 1} \IT[\V])^m}, \exists x \in \V : (\T - \lambda_{k + 1} \IT[\V])^m(x) = y \\
    \implies & \forall y \in \rg{(\T - \lambda_{k + 1} \IT[\V])^m}, \T(y) = \T ((\T - \lambda_{k + 1} \IT[\V])^m(x))           \\
             & = ((\T - \lambda_{k + 1} \IT[\V])^m \T)(x) = ((\T - \lambda_{k + 1} \IT[\V])^m)(\T(x))                          \\
             & \in \rg{(\T - \lambda_{k + 1} \IT[\V])^m}                                                                       \\
    \implies & \T(\rg{(\T - \lambda_{k + 1} \IT[\V])^m}) \subseteq \rg{(\T - \lambda_{k + 1} \IT[\V])^m}.
  \end{align*}
  We claim that \((\T - \lambda_{k + 1} \IT[\V])^m\) maps \(\vs{K}_{\lambda_i}\) onto itself for \(i \in \set{1, \dots, k}\).
  Suppose that \(i \in \set{1, \dots, k}\).
  First we show that \((\T - \lambda_{k + 1} \IT[\V])^m\) maps \(\vs{K}_{\lambda_i}\) into itself.
  This is true since
  \begin{align*}
             & \forall x \in \vs{K}_{\lambda_i}, \exists p \in \Z^+ : (\T - \lambda_i \IT[\V])^p(x) = \zv        &  & \by{7.1.4}    \\
    \implies & \forall x \in \vs{K}_{\lambda_i}, (\T - \lambda_i \IT[\V])^p((\T - \lambda_{k + 1} \IT[\V])^m(x))                    \\
             & = (\T - \lambda_{k + 1} \IT[\V])^m((\T - \lambda_i \IT[\V])^p(x))                                 &  & \by{ex:5.4.4} \\
             & = \zv                                                                                             &  & \by{2.1.2}[a] \\
    \implies & \forall x \in \vs{K}_{\lambda_i}, (\T - \lambda_{k + 1} \IT[\V])^m(x) \in \vs{K}_{\lambda_i}.     &  & \by{7.1.4}
  \end{align*}
  Now we show the claim is true.
  Since \((\T - \lambda_{k + 1} \IT[\V])^m\) maps \(\vs{K}_{\lambda_i}\) into itself and \(\lambda_{k + 1} \neq \lambda_i\), the restriction of \(\T - \lambda_{k + 1} \IT[\V]\) to \(\vs{K}_{\lambda_i}\) is one-to-one (by \cref{7.1}(b)) and hence is onto (\cref{2.4,2.5}).
  One consequence of this is that for \(i \in \set{1, \dots, k}\), \(\vs{K}_{\lambda_i}\) is contained in \(\W\);
  hence \(\lambda_i\) is an eigenvalue of \(\T_{\W}\) for \(i \in \set{1, \dots, k}\).

  Next, observe that \(\lambda_{k + 1}\) is not an eigenvalue of \(\T_{\W}\).
  For suppose that \(\T(v) = \lambda_{k + 1} v\) for some \(v \in \W\).
  Then \(v = (\T - \lambda_{k + 1} \IT[\V])^m(y)\) for some \(y \in \V\), and it follows from \cref{5.4} that
  \[
    \zv = (\T - \lambda_{k + 1} \IT[\V])(v) = (\T - \lambda_{k + 1} \IT[\V])^{m + 1}(y).
  \]
  Therefore \(y \in \vs{K}_{\lambda_{k + 1}}\).
  So by \cref{7.2}(b), \(v = (\T - \lambda_{k + 1} \IT[\V])^m(y) = \zv\).

  Since every eigenvalue of \(\T_{\W}\) is an eigenvalue of \(\T\), the distinct eigenvalues of \(\T_{\W}\) are \(\seq{\lambda}{1,,k}\).
  For each \(i \in \set{1, \dots, k}\), we defined the generalized eigenspace for \(\T_{\W}\) corresponding to \(\lambda_i\) as follow:
  \[
    \vs{K}_{\lambda_i}' = \set{x \in \W | \exists p \in \Z^+ : (\T_{\W} - \lambda_i)^p(x) = \zv}.
  \]
  Clearly we have \(\vs{K}_{\lambda_i}' \subseteq \vs{K}_{\lambda_i}\) for each \(i \in \set{1, \dots, k}\).

  Now let \(x \in \V\).
  Then \((\T - \lambda_{k + 1} \IT[\V])^m(x) \in \W\).
  Since \(\T_{\W}\) has the \(k\) distinct eigenvalues \(\seq{\lambda}{1,,k}\), the induction hypothesis applies.
  Hence there are vectors \(w_i \in \vs{K}_{\lambda_i}'\), \(i \in \set{1, \dots, k}\), such that
  \[
    (\T - \lambda_{k + 1} \IT[\V])^m(x) = \seq[+]{w}{1,,k}.
  \]
  Since \(\vs{K}_{\lambda_i}' \subseteq \vs{K}_{\lambda_i}\) for \(i \in \set{1, \dots, k}\) and \((\T - \lambda_{k + 1} \IT[\V])^m\) maps \(\vs{K}_{\lambda_i}\) onto itself for \(i \in \set{1, \dots, k}\), there exist vectors \(v_i \in \vs{K}_{\lambda_i}\) such that \((\T - \lambda_{k + 1} \IT[\V])^m(v_i) = w_i\) for \(i \in \set{1, \dots, k}\).
  Thus we have
  \[
    (\T - \lambda_{k + 1} \IT[\V])^m(x) = (\T - \lambda_{k + 1} \IT[\V])^m(v_1) + \cdots + (\T - \lambda_{k + 1} \IT[\V])^m(v_{k}),
  \]
  and it follows that \(x - (\seq[+]{v}{1,,k}) \in \vs{K}_{\lambda_{k + 1}}\) since
  \begin{align*}
    \zv & = (\T - \lambda_{k + 1} \IT[\V])^m(x) - (\T - \lambda_{k + 1} \IT[\V])^m(v_1) + \cdots + (\T - \lambda_{k + 1} \IT[\V])^m(v_{k}) \\
        & = (\T - \lambda_{k + 1} \IT[\V])^m(x - (\seq[+]{v}{1,,k})).
  \end{align*}
  Therefore there exists a vector \(v_k \in \vs{K}_{\lambda_{k + 1}}\) such that
  \[
    x = \seq[+]{v}{1,,k+1}.
  \]
\end{proof}

\begin{thm}\label{7.4}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\) such that the characteristic polynomial of \(\T\) splits, and let \(\seq{\lambda}{1,,k} \in \F\) be the distinct eigenvalues of \(\T\) with corresponding multiplicities \(\seq{m}{1,,k}\).
  For \(i \in \set{1, \dots, k}\), let \(\beta_i\) be an ordered basis for \(\vs{K}_{\lambda_i}\) over \(\F\).
  Then the following statements are true.
  \begin{enumerate}
    \item \(\beta_i \cap \beta_j = \varnothing\) for \(i \neq j\).
    \item \(\beta = \seq[\cup]{\beta}{1,,k}\) is an ordered basis for \(\V\) over \(\F\).
    \item \(\dim(\vs{K}_{\lambda_i}) = m_i\) for all \(i \in \set{1, \dots, k}\).
  \end{enumerate}
\end{thm}

\begin{proof}[\pf{7.4}(a)]
  Suppose for sake of contradiction that \(x \in \beta_i \cap \beta_j \subseteq \vs{K}_{\lambda_i} \cap \vs{K}_{\lambda_j}\), where \(i \neq j\).
  By \cref{7.1}(b), \(\T - \lambda_i \IT[\V]\) is one-to-one on \(\vs{K}_{\lambda_j}\), and therefore \((\T - \lambda_i \IT[\V])^p(x) \neq \zv\) for any positive integer \(p\).
  But this contradicts the fact that \(x \in \vs{K}_{\lambda_i}\), and the result follows.
\end{proof}

\begin{proof}[\pf{7.4}(b)]
  Let \(x \in \V\).
  By \cref{7.3}, for \(i \in \set{1, \dots, k}\), there exist vectors \(v_i \in \vs{K}_{\lambda_i}\) such that \(x = \seq[+]{v}{1,,k}\).
  Since each \(v_i\) is a linear combination of the vectors of \(\beta_i\), it follows that \(x\) is a linear combination of the vectors of \(\beta\).
  Therefore \(\beta\) spans \(\V\).
  Let \(q\) be the number of vectors in \(\beta\).
  Then \(\dim(\V) \leq q\).
  For each \(i \in \set{1, \dots, k}\), let \(d_i = \dim(\vs{K}_{\lambda_i})\).
  Then, by \cref{5.3} and \cref{7.2}(a),
  \[
    q = \sum_{i = 1}^k d_i \leq \sum_{i = 1}^k m_i = \dim(\V).
  \]
  Hence \(q = \dim(\V)\).
  Consequently \(\beta\) is a basis for \(\V\) over \(\F\) by \cref{1.6.15}(a).
\end{proof}

\begin{proof}[\pf{7.4}(c)]
  Using the notation and result of (b), we see that \(\sum_{i = 1}^k d_i = \sum_{i = 1}^k m_i\).
  But \(d_i \leq m_i\) by \cref{7.2}(a), and therefore \(d_i = m_i\) for all \(i \in \set{1, \dots, k}\).
\end{proof}

\begin{cor}\label{7.1.5}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\) such that the characteristic polynomial of \(\T\) splits.
  Then \(\T\) is diagonalizable iff \(\vs{E}_{\lambda} = \vs{K}_{\lambda}\) for every eigenvalue \(\lambda\) of \(\T\).
\end{cor}

\begin{proof}[\pf{7.1.5}]
  Combining \cref{7.4}(c) and \cref{5.9}(a), we see that \(\T\) is diagonalizable iff \(\dim(\vs{E}_{\lambda}) = \dim(\vs{K}_{\lambda})\) for each eigenvalue \(\lambda\) of \(\T\).
  But \(\vs{E}_{\lambda} \subseteq \vs{K}_{\lambda}\) (\cref{7.1}(a)), and hence these subspaces have the same dimension iff they are equal (\cref{1.11}).
\end{proof}

\begin{defn}\label{7.1.6}
  Let \(\T\) be a linear operator on a vector space \(\V\) over \(\F\), and let \(x\) be a generalized eigenvector of \(\T\) corresponding to the eigenvalue \(\lambda\).
  Suppose that \(p\) is the smallest positive integer for which \((\T - \lambda \IT[\V])^p(x) = \zv\).
  Then the ordered set
  \[
    \set{(\T - \lambda \IT[\V])^{p - 1}(x), (\T - \lambda \IT[\V])^{p - 2}(x), \dots, (\T - \lambda \IT[\V])(x), x}
  \]
  is called a \textbf{cycle of generalized eigenvectors} of \(\T\) corresponding to \(\lambda\).
  The vectors \((\T - \lambda \IT[\V])^{p - 1}(x)\) and \(x\) are called the \textbf{initial vector} and the \textbf{end vector} of the cycle, respectively.
  We say that the \textbf{length} of the cycle is \(p\).
\end{defn}

\begin{note}
  The initial vector of a cycle of generalized eigenvectors of a linear operator \(\T\) is the only eigenvector of \(\T\) in the cycle.
  Also observe that if \(x\) is an eigenvector of \(\T\) corresponding to the eigenvalue \(\lambda\), then the set \(\set{x}\) is a cycle of generalized eigenvectors of \(\T\) corresponding to \(\lambda\) of length \(1\).
\end{note}

\begin{thm}\label{7.5}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\) whose characteristic polynomial splits, and suppose that \(\beta\) is a basis for \(\V\) over \(\F\) such that \(\beta\) is a disjoint union of cycles of generalized eigenvectors of \(\T\).
  Then the following statements are true.
  \begin{enumerate}
    \item For each cycle \(\gamma\) of generalized eigenvectors contained in \(\beta\), \(\W = \spn{\gamma}\) is \(\T\)-invariant, and \([\T_{\W}]_{\gamma}\) is a Jordan block.
    \item \(\beta\) is a Jordan canonical basis for \(\V\) over \(\F\).
  \end{enumerate}
\end{thm}

\begin{proof}[\pf{7.5}(a)]
  Suppose that \(\gamma\) corresponds to \(\lambda\), \(\gamma\) has length \(p\), and \(x\) is the end vector of \(\gamma\).
  Then \(\gamma = \set{\seq{v}{1,,p}}\), where
  \[
    v_i = (\T - \lambda \IT[\V])^{p - i}(x) \quad \text{ for } i \in \set{1, \dots, p - 1}
  \]
  and \(v_p = x\).
  So
  \[
    (\T - \lambda \IT[\V])(v_1) = (\T - \lambda \IT[\V])^p(x) = \zv,
  \]
  and hence \(\T(v_1) = \lambda v_1\).
  For \(i \in \set{2, \dots, p}\),
  \[
    (\T - \lambda \IT[\V])(v_i) = (\T - \lambda \IT[\V])^{p - (i - 1)}(x) = v_{i - 1}.
  \]
  Therefore \(\T\) maps \(\W\) into itself, and, by the preceding equations, we see that \([\T_{\W}]_{\gamma}\) is a Jordan block.
\end{proof}

\begin{proof}[\pf{7.5}(b)]
  Let \(\seq{\gamma}{1,,k}\) be cycles in \(\beta\) and let \(\W_i = \spn{\gamma_i}\) for each \(i \in \set{1, \dots, k}\).
  By \cref{5.25} we see that \([\T]_{\beta} = [\T_{\W_1}]_{\beta_1} \oplus \cdots \oplus [\T_{\W_k}]_{\beta_k}\).
  By \cref{7.5}(a) we know that \([\T_{\W_i}]_{\gamma_i}\) is a Jordan block for each \(i \in \set{1, \dots, k}\).
  Thus by \cref{7.1.1} \(\beta\) is a Jordan canonical basis for \(\V\) over \(\F\).
\end{proof}

\begin{thm}\label{7.6}
  Let \(\T\) be a linear operator on a vector space \(\V\) over \(\F\), and let \(\lambda\) be an eigenvalue of \(\T\).
  Suppose that \(\seq{\gamma}{1,,q}\) are cycles of generalized eigenvectors of \(\T\) corresponding to \(\lambda\) such that the initial vectors of the \(\gamma_i\)'s are distinct and form a linearly independent set.
  Then the \(\gamma_i\)'s are disjoint, and their union \(\gamma = \bigcup_{i = 1}^q \gamma_i\) is linearly independent.
\end{thm}

\begin{proof}[\pf{7.6}]
  \cref{ex:7.1.5} shows that the \(\gamma_i\)'s are disjoint.

  The proof that \(\gamma\) is linearly independent is by mathematical induction on the number of vectors in \(\gamma\).
  Denote the number as \(n\).
  If \(n = 1\), then the result is clear (\cref{1.5.4}(b)).
  So assume that for some integer \(n \geq 1\) the result is valid.
  Suppose that \(\gamma\) has \(n + 1\) vectors.
  Let \(\W\) be the subspace of \(\V\) over \(\F\) generated by \(\gamma\).
  Clearly \(\W\) is \((\T - \lambda \IT[\V])\)-invariant, and \(\dim(\W) \leq n + 1\).
  Let \(\U\) denote the restriction of \(\T - \lambda \IT[\V]\) to \(\W\).

  For each \(i \in \set{1, \dots, q}\), let \(\gamma_i'\) denote the cycle obtained from \(\gamma_i\) by deleting the end vector.
  Note that if \(\gamma_i\) has length one, then \(\gamma_i' = \varnothing\).
  In the case that \(\gamma_i' \neq \varnothing\), each vector of \(\gamma_i'\) is the image under \(\U\) of a vector in \(\gamma_i\), and conversely, every nonzero image under \(\U\) of a vector of \(\gamma_i\) is contained in \(\gamma_i'\).
  Let \(\gamma' = \bigcup_{i = 1}^q \gamma_i'\).
  Then by the last statement, \(\gamma'\) generates \(\rg{\U}\).
  Furthermore, \(\gamma'\) consists of \(n + 1 - q\) vectors, and the initial vectors of the \(\gamma_i'\)'s are also initial vectors of the \(\gamma_i\)'s.
  Thus we may apply the induction hypothesis to conclude that \(\gamma'\) is linearly independent.
  Therefore \(\gamma'\) is a basis for \(\rg{\U}\) over \(\F\).
  Hence \(\rk{\U} = n + 1 - q\).
  Since the \(q\) initial vectors of the \(\gamma_i\)'s form a linearly independent set and lie in \(\ns{\U}\) (\cref{7.1.6}), we have \(\nt{\U} \geq q\).
  From these inequalities and the dimension theorem, we obtain
  \begin{align*}
    n + 1 & \geq \dim(\W)                      \\
          & = \rk{\U} + \nt{\U}  &  & \by{2.3} \\
          & \geq (n + 1 - q) + q               \\
          & = n + 1.
  \end{align*}
  We conclude that \(\dim(\W) = n + 1\).
  Since \(\gamma\) generates \(\W\) and consists of \(n + 1\) vectors, it must be a basis for \(\W\) over \(\F\).
  Hence \(\gamma\) is linearly independent.
\end{proof}

\begin{cor}\label{7.1.7}
  Every cycle of generalized eigenvectors of a linear operator is linearly independent.
\end{cor}

\begin{proof}[\pf{7.1.7}]
  By \cref{7.6} we simply set \(q = 1\) to conclude that every cycle of generalized eigenvectors of a linear operator is linearly independent.
  Below we provide an alternative proof.

  Let \(\V\) be a vector space over \(\F\) and let \(\T \in \ls(\V)\).
  Let \(\gamma\) be a cycle of generalized eigenvectors of \(\T\) corresponding to \(\lambda \in \F\).
  Let \(p\) be the length of \(\gamma\) and let \(x\) be the end vector of \(\gamma\).
  By \cref{7.1.6} we can define \(v_i = (\T - \lambda \IT[\V])^{p - i}(x)\) for each \(i \in \set{1, \dots, p}\).
  Let \(\seq{a}{1,,p} \in \F\) such that \(\sum_{i = 1}^p a_i v_i = \zv\).
  Since
  \begin{align*}
             & \sum_{i = 1}^p a_i v_i = \zv                                                                                        \\
    \implies & \zv = (\T - \lambda \IT[\V])^{p - 1}\pa{\sum_{i = 1}^p a_i v_i}   &  & \by{2.1.2}[a]                                \\
             & = \sum_{i = 1}^p a_i (\T - \lambda \IT[\V])^{p - 1}(v_i)          &  & \by{2.1.2}[d]                                \\
             & = \sum_{i = 1}^p a_i (\T - \lambda \IT[\V])^{2p - 1 - i}(x)       &  & \by{7.1.6}                                   \\
             & = a_p (\T - \lambda \IT[\V])^{p - 1}(x)                           &  & \by{7.1.6}                                   \\
    \implies & a_p = 0                                                           &  & ((\T - \lambda \IT[\V])^{p - 1}(x) \neq \zv) \\
    \implies & \zv = (\T - \lambda \IT[\V])^{p - 2}\pa{\sum_{i = 1}^p a_i v_i}   &  & \by{2.1.2}[a]                                \\
             & = (\T - \lambda \IT[\V])^{p - 2}\pa{\sum_{i = 1}^{p - 1} a_i v_i} &  & (a_p = 0)                                    \\
             & = \sum_{i = 1}^{p - 1} a_i (\T - \lambda \IT[\V])^{2p - 2 - i}(x) &  & \by{7.1.6}                                   \\
             & = a_{p - 1} (\T - \lambda \IT[\V])^{p - 1}(x)                     &  & \by{7.1.6}                                   \\
    \implies & \seq[=]{a}{p-1,p} = 0                                             &  & ((\T - \lambda \IT[\V])^{p - 1}(x) \neq \zv) \\
    \implies & \vdots                                                                                                              \\
    \implies & \seq[=]{a}{1,,p} = 0,
  \end{align*}
  by \cref{1.5.3} we see that \(\gamma\) is linearly independent.
\end{proof}

\begin{thm}\label{7.7}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\), and let \(\lambda\) be an eigenvalue of \(\T\).
  Then \(\vs{K}_\lambda\) has an ordered basis consisting of a union of disjoint cycles of generalized eigenvectors corresponding to \(\lambda\).
\end{thm}

\begin{proof}[\pf{7.7}]
  The proof is by mathematical induction on \(n = \dim(\vs{K}_\lambda)\).
  The result is clear for \(n = 1\).
  So suppose that for some integer \(n \geq 1\) the result is valid whenever \(\dim(\vs{K}_\lambda) \leq n\), and assume that \(\dim(\vs{K}_\lambda) = n + 1\).
  Let \(\U\) denote the restriction of \(\T - \lambda \IT[\V]\) to \(\vs{K}_\lambda\).
  Then \(\rg{\U}\) is a subspace of \(\vs{K}_\lambda\) of lesser dimension (\cref{7.1.6}), and \(\rg{\U}\) is the space of generalized eigenvectors corresponding to \(\lambda\) for the restriction of \(\T\) to \(\rg{\U}\).
  Therefore, by the induction hypothesis, there exist disjoint cycles \(\seq{\gamma}{1,,q}\) of generalized eigenvectors of this restriction, and hence of \(\T\) itself, corresponding to \(\lambda\) for which \(\gamma = \bigcup_{i = 1}^q \gamma_i\) is a basis for \(\rg{\U}\).
  For \(i \in \set{1, \dots, q}\), the end vector of \(\gamma_i\) is the image under \(\U\) of a vector \(v_i \in \vs{K}_\lambda\), and so we can extend each \(\gamma_i\) to a larger cycle \(\tilde{\gamma}_i = \gamma_i \cup \set{v_i}\) of generalized eigenvectors of \(\T\) corresponding to \(\lambda\).
  For \(i \in \set{1 \dots, q}\), let \(w_i\) be the initial vector of \(\tilde{\gamma}_i\) (and hence of \(\gamma_i\)).
  Since \(\set{\seq{w}{1,,q}}\) is a linearly independent subset of \(\vs{E}_\lambda\) (\cref{7.1.3}), this set can be extended to a basis \(\set{\seq{w}{1,,q}, \seq{u}{1,,s}}\) for \(\vs{E}_\lambda\).
  Then \(\seq{\tilde{\gamma}}{1,,q}, \set{u_1}, \dots, \set{u_s}\) are disjoint cycles of generalized eigenvectors of \(\T\) corresponding to \(\lambda\) (\((\T - \lambda \IT[\V](u_j)) = \zv\) for all \(j \in \set{1, \dots, s}\)) such that the initial vectors of these cycles are linearly independent.
  Therefore their union \(\tilde{\gamma}\) is a linearly independent subset of \(\vs{K}_\lambda\) by \cref{7.6}.

  We show that \(\tilde{\gamma}\) is a basis for \(\vs{K}_\lambda\).
  Suppose that \(\gamma\) consists of \(r = \rk{\U}\) vectors.
  Then \(\tilde{\gamma}\) consists of \(r + q + s\) vectors.
  Furthermore, since \(\set{\seq{w}{1,,q}, \seq{u}{1,,s}}\) is a basis for \(\vs{E}_\lambda = \ns{\U}\) over \(\F\), it follows that \(\nt{\U} = q + s\).
  Therefore
  \[
    \dim(\vs{K}_{\lambda}) = \rk{\U} + \nt{\U} = r + q + s.
  \]
  So \(\tilde{\gamma}\) is a linearly independent subset of \(\vs{K}_\lambda\) containing \(\dim(\vs{K}_\lambda)\) vectors.
  It follows that \(\tilde{\gamma}\) is a basis for \(\vs{K}_\lambda\) (\cref{1.6.15}(b)).
\end{proof}

\begin{cor}\label{7.1.8}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\) whose characteristic polynomial splits.
  Then \(\T\) has a Jordan canonical form.
\end{cor}

\begin{proof}[\pf{7.1.8}]
  Let \(\seq{\lambda}{1,,k} \in \F\) be the distinct eigenvalues of \(\T\).
  By \cref{7.7}, for each \(i \in \set{1, \dots, k}\), there is an ordered basis \(\beta_i\) for \(\V\) over \(\F\) consisting of a disjoint union of cycles of generalized eigenvectors corresponding to \(\lambda_i\).
  Let \(\beta = \seq[\cup]{\beta}{1,,k}\).
  Then, by \cref{7.4}(b), \(\beta\) is an ordered basis for \(\V\) over \(\F\).
\end{proof}

\begin{defn}\label{7.1.9}
  Let \(A \in \ms[n][n][\F]\) be such that the characteristic polynomial of \(A\) (and hence of \(\L_A\)) splits.
  Then the \textbf{Jordan canonical form} of \(A\) is defined to be the Jordan canonical form of the linear operator \(\L_A\) on \(\vs{F}^n\).
\end{defn}

\begin{cor}\label{7.1.10}
  Let \(A \in \ms[n][n][\F]\) whose characteristic polynomial splits.
  Then \(A\) has a Jordan canonical form \(J\), and \(A\) is similar to \(J\).
\end{cor}

\begin{proof}[\pf{7.1.10}]
  By \cref{5.1.6} we know that the characteristic polynomial of \(\L_A\) splits.
  Thus by \cref{7.1.8,7.1.9} \(A\) has a Jordan canonical form \(J\).
  Let \(\beta\) be the standard ordered basis for \(\vs{F}^n\) over \(\F\).
  Let \(\gamma\) be a Jordan canonical basis for \(A\).
  Then we have
  \begin{align*}
    A & = [\L_A]_{\beta}                                                        &  & \by{2.15}[a] \\
      & = [\IT[\V]]_{\gamma}^{\beta} [\L_A]_{\gamma} [\IT[\V]]_{\beta}^{\gamma} &  & \by{2.23}    \\
      & = J                                                                     &  & \by{7.1.1}
  \end{align*}
  and thus by \cref{2.5.4} \(A, J\) are similar.
\end{proof}

\begin{note}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\), and suppose that the characteristic polynomial of \(\T\) splits.
  By \cref{5.11}, \(\T\) is diagonalizable iff \(\V\) is the direct sum of the eigenspaces of \(\T\).
  If \(\T\) is diagonalizable, then the eigenspaces and the generalized eigenspaces coincide (\cref{7.1.5}).
  \cref{7.8}, which is optional, extends \cref{5.11} to the nondiagonalizable case.
\end{note}

\begin{thm}\label{7.8}
  Let \(\T\) be a linear operator on a finite-dimensional vector space \(\V\) over \(\F\) whose characteristic polynomial splits.
  Then \(\V\) is the direct sum of the generalized eigenspaces of \(\T\).
\end{thm}

\begin{proof}[\pf{7.8}]
  Let \(\seq{\lambda}{1,,k} \in \F\) be eigenvalues of \(\T\).
  By \cref{7.1.8} we see that \(\T\) has a Jordan canonical form.
  By \cref{7.7}, for each \(i \in \set{1, \dots, k}\), there exists an ordered basis \(\beta_i\) for \(\vs{K}_{\lambda_i}\) over \(\F\) such that \(\beta_i\) is consist of disjoint union of cycles of generalized eigenvectors corresponding to \(\lambda_i\), and \(\beta = \bigcup_{i = 1}^k \beta_i\) is an ordered basis for \(\V\) over \(\F\).
  By \cref{7.4} we see that \(\beta_i \cap \beta_j = \varnothing\) for all \(i \neq j\).
  By \cref{7.3} we see that \(\V\) is the direct sum of the generalized eigenspaces of \(\T\).
\end{proof}

\exercisesection

\setcounter{ex}{3}
\begin{ex}\label{ex:7.1.4}
  Let \(\T\) be a linear operator on a vector space \(\V\) over \(\F\), and let \(\gamma\) be a cycle of generalized eigenvectors that corresponds to the eigenvalue \(\lambda\).
  Prove that \(\spn{\gamma}\) is a \(\T\)-invariant subspace of \(\V\) over \(\F\).
\end{ex}

\begin{proof}[\pf{ex:7.1.4}]
  Suppose that \(\gamma\) has length \(p\) and end vector \(x \in \V\).
  By \cref{7.1.6} we see that
  \[
    \gamma = \set{(\T - \lambda \IT[\V])^{p - 1}(x), \dots, (\T - \lambda \IT[\V])(x), x}.
  \]
  For each \(i \in \set{1, \dots, p}\), we define \(v_i = (\T - \lambda \IT[\V])^{p - i}(x)\).
  Observe that
  \begin{align*}
    \forall i \in \set{1, \dots, p}, (\T - \lambda \IT[\V])(v_i) & = (\T - \lambda \IT[\V])^{p - (i - 1)}(x)        \\
                                                                 & = \begin{dcases}
                                                                       \zv       & \text{if } i = 1                   \\
                                                                       v_{i - 1} & \text{if } i \in \set{2, \dots, p}
                                                                     \end{dcases} &  & \by{7.1.6}
  \end{align*}
  and
  \[
    \forall i \in \set{1, \dots, p}, \T(v_i) = \begin{dcases}
      \lambda v_1             & \text{if } i = 1                   \\
      \lambda v_i + v_{i - 1} & \text{if } i \in \set{2, \dots, p}
    \end{dcases}.
  \]
  Let \(y \in \spn{\gamma}\).
  By \cref{1.4.3} there exist some \(\seq{a}{1,,p} \in \F\) such that \(y = \sum_{i = 1}^p a_i v_i\).
  Since
  \begin{align*}
    \T(y) & = \T\pa{\sum_{i = 1}^p a_i v_i}                                  &  & \by{1.4.3}    \\
          & = \sum_{i = 1}^p a_i \T(v_i)                                     &  & \by{2.1.2}[d] \\
          & = a_1 \lambda v_1 + \sum_{i = 2}^p a_i (\lambda v_i + v_{i - 1}) &  & \by{7.1.6}    \\
          & \in \spn{\gamma},                                                &  & \by{1.4.3}
  \end{align*}
  by \cref{5.4.1} we see that \(\spn{\gamma}\) is \(\T\)-invariant.
\end{proof}

\begin{ex}\label{ex:7.1.5}
  Let \(\seq{\gamma}{1,,p}\) be cycles of generalized eigenvectors of a linear operator \(\T\) corresponding to an eigenvalue \(\lambda\).
  Prove that if the initial eigenvectors are distinct, then the cycles are disjoint.
\end{ex}

\begin{proof}[\pf{ex:7.1.5}]
  Suppose for sake of contradiction that there exist \(i, j \in \set{1, \dots, p}\) such that \(i \neq j\) and \(\gamma_i \cap \gamma_j \neq \varnothing\).
  Let \(m, n\) be lengths of \(\gamma_i, \gamma_j\), respectively.
  Let \(x, y\) be the end vector of \(\gamma_i, \gamma_j\), respectively.
  Then we have
  \begin{align*}
    \gamma_i & = \set{(\T - \lambda \IT[\V])^{m - 1}(x), \dots, (\T - \lambda \IT[\V])(x), x}; &  & \by{7.1.6} \\
    \gamma_j & = \set{(\T - \lambda \IT[\V])^{n - 1}(y), \dots, (\T - \lambda \IT[\V])(y), y}. &  & \by{7.1.6}
  \end{align*}
  By hypothesis we have \((\T - \lambda \IT[\V])^{m - 1}(x) \neq (\T - \lambda \IT[\V])^{n - 1}(y)\).
  Let \(z \in \beta_i \cap \beta_j\).
  Then there exist \(m' \in \set{0, \dots, m - 1}\) and \(n' \in \set{0, \dots, n - 1}\) such that
  \[
    z = (\T - \lambda \IT[\V])^{m'}(x) = (\T - \lambda \IT[\V])^{n'}(y).
  \]
  We cannot have \(m - m' < n - n'\) since
  \begin{align*}
             & (\T - \lambda \IT[\V])^{m - m'}(z) = (\T - \lambda \IT[\V])^m(x) = \zv     &  & \by{7.1.6}    \\
    \implies & (\T - \lambda \IT[\V])^{n - 1}(y) = (\T - \lambda \IT[\V])^{n - 1 - n'}(z) &  & \by{7.1.6}    \\
             & = (\T - \lambda \IT[\V])^{n - n' - m + m' + m - m' - 1}(z)                                    \\
             & = (\T - \lambda \IT[\V])^{n - n' - m + m' - 1}(\zv)                        &  & \by{7.1.6}    \\
             & = \zv                                                                      &  & \by{2.1.2}[a] \\
    \implies & \gamma_j \text{ has length } \leq n - 1,                                   &  & \by{7.1.6}
  \end{align*}
  a contradiction.
  Similarly we cannot have \(n - n' < m - m'\).
  Thus we must have \(n - n = m - m'\).
  But this means
  \[
    (\T - \lambda \IT[\V])^{m - 1}(x) = (\T - \lambda \IT[\V])^{m - 1 - m'}(z) = (\T - \lambda \IT[\V])^{n - 1 - n'}(z) = (\T - \lambda \IT[\V])^{n - 1}(y),
  \]
  a contradiction.
  Thus \(\gamma_i \cap \gamma_j = \varnothing\).
\end{proof}
